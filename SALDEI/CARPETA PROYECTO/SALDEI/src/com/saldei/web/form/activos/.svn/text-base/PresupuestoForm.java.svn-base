/*
 * Generated by MyEclipse Struts
 * Template path: templates/java/JavaClass.vtl
 */
package com.saldei.web.form.activos;


import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.Iterator;
import java.util.List;
import java.util.Map;
import java.util.ResourceBundle;
import java.util.Set;

import javax.servlet.http.HttpServletRequest;

import org.apache.struts.action.ActionError;
import org.apache.struts.action.ActionErrors;
import org.apache.struts.action.ActionForm;
import org.apache.struts.action.ActionMapping;

import com.saldei.hibernate.tables.activos.ActPresupuesto;
import com.saldei.hibernate.tables.activos.ActPresupuestoDAO;

/** 
 * MyEclipse Struts
 * Creation date: 05-25-2009
 * 
 * XDoclet definition:
 * @struts.form name="presupuestoForm"
 */
public class PresupuestoForm extends ActionForm {
	/*
	 * Generated fields
	 */

	/**
	 * 
	 */
	private static final long serialVersionUID = 1L;
	
	//SimpleDateFormat sdf = new SimpleDateFormat("dd/mm/yyyy");
	
	private String pptoLink;
	private String estadoDescr;
	
	ActPresupuesto actPresupuesto = new ActPresupuesto();


	


	/*
	 * Generated Methods
	 */

	/** 
	 * Method validate
	 * @param mapping
	 * @param request
	 * @return ActionErrors
	 */
	@SuppressWarnings("deprecation")
	public void validate(ActionMapping mapping,
			HttpServletRequest request, ActionErrors errors) {
		// TODO Auto-generated method stub
		String accion = request.getParameter("accion");
		accion = (accion==null)?"":accion;
		
		ResourceBundle mensajes = ResourceBundle.getBundle("com.saldei.web.ApplicationResources");
		if(!accion.equals(mensajes.getString("opc.cancel")) && !accion.equals(mensajes.getString("opc.find"))){
			String valor  = getFecha_ini(); 
			if(this.getFecha_ini() == null || this.getFecha_ini().trim().equals("")){
				errors.add("presupuesto.fechaIni.requerido", new ActionError("presupuesto.fechaIni.requerido"));
			}
			
			if(this.getFecha_fin() == null || this.getFecha_fin().trim().equals("")){
				errors.add("presupuesto.fechaFin.requerido", new ActionError("presupuesto.fechaFin.requerido"));
			}
			
			if(this.getFechaInicial().compareTo(this.getFechaFinal())>0 ){
				errors.add("ppto.fecha.error", new ActionError("ppto.fecha.error"));
			}
			
			List data;
			ActPresupuestoDAO actPresupuestoDAO = new ActPresupuestoDAO();
			if(this.getEstado().equals("A")){
				try{
				data = actPresupuestoDAO.findByEstado("A");
				if(!data.isEmpty())
					errors.add("ppto.mensajeError.error", new ActionError("ppto.mensajeError.error.estado"));
				} catch (Exception e) {
					e.printStackTrace();			
					// TODO: handle exception
				}
			}
			//String fechaIni;
			//String fechaFin;
			SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd");
			SimpleDateFormat sdf2 = new SimpleDateFormat("dd/MM/yyyy");
			Date fei = new Date();
			Date fef = new Date();
			try{
				fei = sdf2.parse(this.getFecha_ini());
				fef = sdf2.parse(this.getFecha_fin());
			}
			catch (Exception e) {
				e.printStackTrace();
			}
			
			try{
			data = actPresupuestoDAO.traslapada(sdf.format(fei),sdf.format(fef),this.getCodPresupuesto().toString());
			if(!data.isEmpty())
				errors.add("ppto.mensajeError.error", new ActionError("ppto.mensajeError.error.fechas"));
			} catch (Exception e) {
				e.printStackTrace();			
				// TODO: handle exception
			}
			
		}
	}
	
	/** 
	 * Method reset
	 * @param mapping
	 * @param request
	 */
	public void reset(ActionMapping mapping, HttpServletRequest request) {
		// TODO Auto-generated method stub
		this.actPresupuesto = new ActPresupuesto();

	}

	/**
	 * @return the actPresupuesto
	 */
	public ActPresupuesto getActPresupuesto() {
		return actPresupuesto;
	}

	/**
	 * @param actPresupuesto the actPresupuesto to set
	 */
	public void setActPresupuesto(ActPresupuesto actPresupuesto) {
		this.actPresupuesto = actPresupuesto;
	}







	/**
	 * @return
	 * @see com.saldei.hibernate.tables.activos.AbstractActPresupuesto#getActDetPresupuestos()
	 */
	public Set getActDetPresupuestos() {
		return actPresupuesto.getActDetPresupuestos();
	}

	/**
	 * @return
	 * @see com.saldei.hibernate.tables.activos.AbstractActPresupuesto#getCodPresupuesto()
	 */
	public Integer getCodPresupuesto() {
		return actPresupuesto.getCodPresupuesto();
	}

	/**
	 * @return
	 * @see com.saldei.hibernate.tables.activos.AbstractActPresupuesto#getEstado()
	 */
	public String getEstado() {
		return actPresupuesto.getEstado();
	}

	/**
	 * @return
	 * @see com.saldei.hibernate.tables.activos.AbstractActPresupuesto#getFechaCreacion()
	 */
	public Date getFechaCreacion() {
		return actPresupuesto.getFechaCreacion();
	}

	/**
	 * @return
	 * @see com.saldei.hibernate.tables.activos.AbstractActPresupuesto#getFechaFinal()
	 */
	public Date getFechaFinal() {
		return actPresupuesto.getFechaFinal();
	}

	/**
	 * @return
	 * @see com.saldei.hibernate.tables.activos.AbstractActPresupuesto#getFechaInicial()
	 */
	public Date getFechaInicial() {
		return actPresupuesto.getFechaInicial();
	}

	/**
	 * @param actDetPresupuestos
	 * @see com.saldei.hibernate.tables.activos.AbstractActPresupuesto#setActDetPresupuestos(java.util.Set)
	 */
	public void setActDetPresupuestos(Set actDetPresupuestos) {
		actPresupuesto.setActDetPresupuestos(actDetPresupuestos);
	}

	/**
	 * @param codPresupuesto
	 * @see com.saldei.hibernate.tables.activos.AbstractActPresupuesto#setCodPresupuesto(java.lang.Integer)
	 */
	public void setCodPresupuesto(Integer codPresupuesto) {
		actPresupuesto.setCodPresupuesto(codPresupuesto);
	}

	/**
	 * @param estado
	 * @see com.saldei.hibernate.tables.activos.AbstractActPresupuesto#setEstado(boolean)
	 */
	public void setEstado(String estado) {
		actPresupuesto.setEstado(estado);
	}

	/**
	 * @param fechaCreacion
	 * @see com.saldei.hibernate.tables.activos.AbstractActPresupuesto#setFechaCreacion(java.util.Date)
	 */
	public void setFechaCreacion(Date fechaCreacion) {
		actPresupuesto.setFechaCreacion(fechaCreacion);
	}

	/**
	 * @param fechaFinal
	 * @see com.saldei.hibernate.tables.activos.AbstractActPresupuesto#setFechaFinal(java.util.Date)
	 */
	public void setFechaFinal(Date fechaFinal) {
		actPresupuesto.setFechaFinal(fechaFinal);
	}

	/**
	 * @param fechaInicial
	 * @see com.saldei.hibernate.tables.activos.AbstractActPresupuesto#setFechaInicial(java.util.Date)
	 */
	public void setFechaInicial(Date fechaInicial) {
		actPresupuesto.setFechaInicial(fechaInicial);
	}

	/**
	 * @return
	 * @see com.saldei.hibernate.tables.activos.ActPresupuesto#getFecha_fin()
	 */
	public String getFecha_fin() {
		return actPresupuesto.getFecha_fin();
	}

	/**
	 * @return
	 * @see com.saldei.hibernate.tables.activos.ActPresupuesto#getFecha_ini()
	 */
	public String getFecha_ini() {
		return actPresupuesto.getFecha_ini();
	}

	/**
	 * @param fecha_fin
	 * @throws ParseException
	 * @see com.saldei.hibernate.tables.activos.ActPresupuesto#setFecha_fin(java.lang.String)
	 */
	public void setFecha_fin(String fecha_fin) throws ParseException {
		actPresupuesto.setFecha_fin(fecha_fin);
	}

	/**
	 * @param fecha_ini
	 * @throws ParseException
	 * @see com.saldei.hibernate.tables.activos.ActPresupuesto#setFecha_ini(java.lang.String)
	 */
	public void setFecha_ini(String fecha_ini) throws ParseException {
		actPresupuesto.setFecha_ini(fecha_ini);
	}


	public String getPptoLink() {
		return actPresupuesto.getPptoLink();
	}


	public void setPptoLink(String pptoLink) {
		this.pptoLink = pptoLink;
	}


	public String getEstadoDescr() {
		return estadoDescr;
	}


	public void setEstadoDescr(String estadoDescr) {
		this.estadoDescr = estadoDescr;
	}

	@SuppressWarnings("deprecation")
	public void validateBorra(ActionMapping mapping,
			HttpServletRequest request, ActionErrors errors) {
		// TODO Auto-generated method stub
		String accion = request.getParameter("accion");
		accion = (accion==null)?"":accion;
		
		ResourceBundle mensajes = ResourceBundle.getBundle("com.saldei.web.ApplicationResources");
		if(!accion.equals(mensajes.getString("opc.cancel")) && !accion.equals(mensajes.getString("opc.find"))){
			if(this.getEstado().equals("A"))
				errors.add("ppto.mensajeError.error", new ActionError("ppto.mensajeError.error.preact"));
		}
	}

}