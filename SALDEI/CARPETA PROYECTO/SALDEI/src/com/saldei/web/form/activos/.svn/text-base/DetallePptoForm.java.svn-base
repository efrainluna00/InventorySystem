/*
 * Generated by MyEclipse Struts
 * Template path: templates/java/JavaClass.vtl
 */
package com.saldei.web.form.activos;

import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.ResourceBundle;

import javax.servlet.http.HttpServletRequest;

import org.apache.struts.action.ActionError;
import org.apache.struts.action.ActionErrors;
import org.apache.struts.action.ActionForm;
import org.apache.struts.action.ActionMapping;

import com.saldei.hibernate.tables.activos.ActActivo;
import com.saldei.hibernate.tables.activos.ActCuenta;
import com.saldei.hibernate.tables.activos.ActDetPresupuesto;
import com.saldei.hibernate.tables.activos.ActDetPresupuestoId;
import com.saldei.hibernate.tables.activos.ActPresupuesto;

/** 
 * MyEclipse Struts
 * Creation date: 06-09-2009
 * 
 * XDoclet definition:
 * @struts.form name="detallePptoForm"
 */
public class DetallePptoForm extends ActionForm {
	/*
	 * Generated fields
	 */

	/**
	 * 
	 */
	private static final long serialVersionUID = 3933488442117548112L;
	/** actDetPresupuesto property */
	private ActDetPresupuesto actDetPresupuesto = new ActDetPresupuesto(new ActDetPresupuestoId(new ActPresupuesto(), new ActCuenta()));
	private String fecha_ini;
	private String fecha_fin;
	private String estadoPre;
	private Double montoTemp;
	SimpleDateFormat sdf = new SimpleDateFormat("yyyy-mm-dd");
	private String montoMoney;
	private String saldoActualMoney;
	
	/*
	 * Generated Methods
	 */

	/**
	 * @return
	 * @see com.saldei.hibernate.tables.activos.AbstractActCuenta#getCodCuenta()
	 */
	public String getCodCuenta() {
		return this.actDetPresupuesto.getId().getActCuenta().getCodCuenta();
	}

	/**
	 * @return
	 * @see com.saldei.hibernate.tables.activos.AbstractActCuenta#getDescripcion()
	 */
	public String getDescripcion() {
		return this.actDetPresupuesto.getId().getActCuenta().getDescripcion();
	}

	/**
	 * @param codCuenta
	 * @see com.saldei.hibernate.tables.activos.AbstractActCuenta#setCodCuenta(java.lang.String)
	 */
	public void setCodCuenta(String codCuenta) {
		this.actDetPresupuesto.getId().getActCuenta().setCodCuenta(codCuenta);
	}

	/**
	 * @param descripcion
	 * @see com.saldei.hibernate.tables.activos.AbstractActCuenta#setDescripcion(java.lang.String)
	 */
	public void setDescripcion(String descripcion) {
		this.actDetPresupuesto.getId().getActCuenta().setDescripcion(descripcion);
	}

	/** 
	 * Method validate
	 * @param mapping
	 * @param request
	 * @return ActionErrors
	 */
	public void validate(ActionMapping mapping,
			HttpServletRequest request, ActionErrors errors) {
		// TODO Auto-generated method stub
		String accion = request.getParameter("accion");
		accion = (accion==null)?"":accion;
		
		ResourceBundle mensajes = ResourceBundle.getBundle("com.saldei.web.ApplicationResources");
		if(!accion.equals(mensajes.getString("opc.cancel")) && !accion.equals(mensajes.getString("opc.find"))){
			if(this.actDetPresupuesto.getId().getActCuenta().getCodCuenta() == null || this.actDetPresupuesto.getId().getActCuenta().getCodCuenta().trim().equals("")){
				errors.add("detpresupuesto.cuenta.requerido", new ActionError("detpresupuesto.cuenta.requerido"));
			}
			
			if(this.actDetPresupuesto.getMonto() == 0){
				errors.add("detpresupuesto.monto.requerido", new ActionError("detpresupuesto.monto.requerido"));
			}else
			if(this.actDetPresupuesto.getMonto() < 0){
				errors.add("detpresupuesto.monto.requerido", new ActionError("detpresupuesto.monto.mayor"));
			}
			
		}			
	}

	/** 
	 * Method reset
	 * @param mapping
	 * @param request
	 */
	public void reset(ActionMapping mapping, HttpServletRequest request) {
		// TODO Auto-generated method stub
		ActPresupuesto actPresupuesto = this.actDetPresupuesto.getId().getActPresupuesto();
		this.actDetPresupuesto = new ActDetPresupuesto(new ActDetPresupuestoId(new ActPresupuesto(),new ActCuenta()));
		this.actDetPresupuesto.getId().setActPresupuesto(actPresupuesto);
	}

	/** 
	 * Returns the actDetPresupuesto.
	 * @return ActDetPresupuesto
	 */
	public ActDetPresupuesto getActDetPresupuesto() {
		return actDetPresupuesto;
	}

	/** 
	 * Set the actDetPresupuesto.
	 * @param actDetPresupuesto The actDetPresupuesto to set
	 */
	public void setActDetPresupuesto(ActDetPresupuesto actDetPresupuesto) {
		this.actDetPresupuesto = actDetPresupuesto;
	}

	/**
	 * @return
	 * @see com.saldei.hibernate.tables.activos.AbstractActDetPresupuesto#getId()
	 */
	public ActDetPresupuestoId getId() {
		return actDetPresupuesto.getId();
	}

	/**
	 * @return
	 * @see com.saldei.hibernate.tables.activos.AbstractActDetPresupuesto#getMonto()
	 */
	public double getMonto() {
		return actDetPresupuesto.getMonto();
	}

	/**
	 * @param id
	 * @see com.saldei.hibernate.tables.activos.AbstractActDetPresupuesto#setId(com.saldei.hibernate.tables.activos.ActDetPresupuestoId)
	 */
	public void setId(ActDetPresupuestoId id) {
		actDetPresupuesto.setId(id);
	}

	/**
	 * @param monto
	 * @see com.saldei.hibernate.tables.activos.AbstractActDetPresupuesto#setMonto(double)
	 */
	public void setMonto(double monto) {
		actDetPresupuesto.setMonto(monto);
	}



	/**
	 * @return
	 * @see com.saldei.hibernate.tables.activos.AbstractActPresupuesto#getCodPresupuesto()
	 */
	public Integer getCodPresupuesto() {
		return this.actDetPresupuesto.getId().getActPresupuesto().getCodPresupuesto();
	}

	/**
	 * @return
	 * @see com.saldei.hibernate.tables.activos.AbstractActPresupuesto#getEstado()
	 */
	public String getEstado() {
		return this.actDetPresupuesto.getId().getActPresupuesto().getEstado();
	}

	/**
	 * @return
	 * @see com.saldei.hibernate.tables.activos.AbstractActPresupuesto#getFechaFinal()
	 */
	public Date getFechaFinal() {
		return this.actDetPresupuesto.getId().getActPresupuesto().getFechaFinal();
	}

	/**
	 * @return
	 * @see com.saldei.hibernate.tables.activos.AbstractActPresupuesto#getFechaInicial()
	 */
	public Date getFechaInicial() {
		return this.actDetPresupuesto.getId().getActPresupuesto().getFechaInicial();
	}

	/**
	 * @param codPresupuesto
	 * @see com.saldei.hibernate.tables.activos.AbstractActPresupuesto#setCodPresupuesto(java.lang.Integer)
	 */
	public void setCodPresupuesto(Integer codPresupuesto) {
		this.actDetPresupuesto.getId().getActPresupuesto().setCodPresupuesto(codPresupuesto);
	}

	/**
	 * @param estado
	 * @see com.saldei.hibernate.tables.activos.AbstractActPresupuesto#setEstado(java.lang.String)
	 */
	public void setEstado(String estado) {
		this.actDetPresupuesto.getId().getActPresupuesto().setEstado(estado);
	}

	/**
	 * @param fechaFinal
	 * @see com.saldei.hibernate.tables.activos.AbstractActPresupuesto#setFechaFinal(java.util.Date)
	 */
	public void setFechaFinal(Date fechaFinal) {
		this.actDetPresupuesto.getId().getActPresupuesto().setFechaFinal(fechaFinal);
	}

	/**
	 * @param fechaInicial
	 * @see com.saldei.hibernate.tables.activos.AbstractActPresupuesto#setFechaInicial(java.util.Date)
	 */
	public void setFechaInicial(Date fechaInicial) {
		this.actDetPresupuesto.getId().getActPresupuesto().setFechaInicial(fechaInicial);
	}

	/**
	 * @return the fecha_ini
	 */
	public String getFecha_ini() {
		/*String fecha = "";
		if(this.actDetPresupuesto.getId().getActPresupuesto().getFechaInicial() != null)
			fecha = sdf.format(this.actDetPresupuesto.getId().getActPresupuesto().getFechaInicial());
		return fecha;*/
		return fecha_ini;
	}

	/**
	 * @param fecha_ini the fecha_ini to set
	 */
	public void setFecha_ini(String fecha_ini) {
		this.fecha_ini = fecha_ini;
		/*try {
			this.actDetPresupuesto.getId().getActPresupuesto().setFechaInicial(sdf.parse(fecha_ini));
		} catch (ParseException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}*/
	}

	/**
	 * @return the fecha_fin
	 */
	public String getFecha_fin() {
	/*	String fecha = "";
		if(this.actDetPresupuesto.getId().getActPresupuesto().getFechaFinal() != null)
			fecha = sdf.format(this.actDetPresupuesto.getId().getActPresupuesto().getFechaFinal());
		return fecha;
		*/
		return fecha_fin;
	}

	/**
	 * @param fecha_fin the fecha_fin to set
	 */
	public void setFecha_fin(String fecha_fin) {
		this.fecha_fin = fecha_fin;
		/*
		try {
			this.actDetPresupuesto.getId().getActPresupuesto().setFechaFinal(sdf.parse(fecha_fin));
		} catch (ParseException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}*/
	}

	/**
	 * @return
	 * @see com.saldei.hibernate.tables.activos.AbstractActDetPresupuesto#getSaldoActual()
	 */
	public double getSaldoActual() {
		return actDetPresupuesto.getSaldoActual();
	}

	/**
	 * @param saldoActual
	 * @see com.saldei.hibernate.tables.activos.AbstractActDetPresupuesto#setSaldoActual(double)
	 */
	public void setSaldoActual(double saldoActual) {
		actDetPresupuesto.setSaldoActual(saldoActual);
	}
	
	
	public boolean actualizacionValida(){
		/*if(this.montoTemp==this.getSaldoActual())
			return true;
		if(this.montoTemp<this.getMonto()){;
			this.setSaldoActual(this.getSaldoActual() + (this.getMonto() - this.montoTemp));
			return true;
			}
		if(this.montoTemp>this.getMonto()){
			if(this.getMonto()>=this.getSaldoActual())
				this.setSaldoActual(this.getSaldoActual() - (this.montoTemp - this.getMonto()));
			return false;
			}*/
	   
	   double diferencia;
	   diferencia =   this.getMonto()-this.montoTemp;
	   diferencia =  this.getSaldoActual() + diferencia;
	   if (diferencia <= 0){
		   return false;
	   }
	   this.setSaldoActual(diferencia);
	   return true;
	}

	/**
	 * @return the saldoTemp
	 */

	/**
	 * @return the montoTemp
	 */
	public Double getMontoTemp() {
		return montoTemp;
	}

	/**
	 * @param montoTemp the montoTemp to set
	 */
	public void setMontoTemp(Double montoTemp) {
		this.montoTemp = montoTemp;
	}

	public String getEstadoPre() {
		return estadoPre;
	}

	public void setEstadoPre(String estadoPre) {
		this.estadoPre = estadoPre;
	}

	public String getUsuarioMov() {
		return actDetPresupuesto.getUsuarioMov();
	}

	public void setUsuarioMov(String usuarioMov) {
		actDetPresupuesto.setUsuarioMov(usuarioMov);
	}

	public String getMontoMoney() {
		return montoMoney;
	}

	public void setMontoMoney(String montoMoney) {
		this.montoMoney = montoMoney;
	}

	public String getSaldoActualMoney() {
		return saldoActualMoney;
	}

	public void setSaldoActualMoney(String saldoActualMoney) {
		this.saldoActualMoney = saldoActualMoney;
	}
	
	
}
